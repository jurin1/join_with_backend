<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: board.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: board.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>let cards = [];
let currentDraggedElement;
let currentChecktContact = [];
let user = [];
let categorys = [];
let subtasksArrayEditTask = [];


/**
 * Initializes the board by rendering tasks and updating the HTML layout.
 * This function should be called when the page is loaded or when the tasks need to be refreshed.
 */
async function initBoard() {
    render();
    updateHTML();
    contacts = await getItem('contacts');
}

/**
 * Updates the HTML layout of the board by categorizing and displaying tasks.
 * This function asynchronously loads tasks for a user and updates each category section on the page.
 */
async function updateHTML() {
    cards = await getItem("tasks");
    const categories = ['todo', 'progress', 'feedback', 'done'];
    for (const category of categories) {

        let categoryElements = cards.filter(t => t['status'] === category);
        document.getElementById(category).innerHTML = '';
        for (let i = 0; i &lt; categoryElements.length; i++) {
            let element = categoryElements[i];
            document.getElementById(category).innerHTML += generateCardHTML(element);
            userTags(element);
            updateProgressBar(element);
            assignIcon(element);
        }
    }
    emptyCategory();
}

/**
 * Sets the current element being dragged to the specified card ID.
 * This function is triggered when a drag operation begins on a task card.
 * @param {number} id - The ID of the card being dragged.
 */
function startDragging(id) {
    currentDraggedElement = id;
}

/**
 * Allows a drop operation to occur on a drag target by preventing the default handling of the event.
 * This is typically used in conjunction with drag events to enable dropping on specific elements.
 * @param {Event} ev - The dragover event.
 */
function allowDrop(ev) {
    ev.preventDefault();
}

/**
 * Moves the currently dragged card to a specified category.
 * After moving the card, this function updates the task list and visual layout.
 * @param {string} category - The category to move the card to.
 */
async function moveTo(category) {

    body = JSON.stringify({
        status: category,
    });
    await updateItem('tasks', currentDraggedElement, body);

    // await setItem('tasks/', tasks)    
    updateHTML();
    removeHighlight(category);
}

/**
 * Applies a visual highlight to an element, indicating it is a valid drop target during a drag operation.
 * @param {string} id - The ID of the element to be highlighted.
 */
function highlight(id) {
    document.getElementById(id).classList.add('drag-area-highlight');
}

/**
 * Removes the visual highlight from an element, used when a drag operation is complete or leaves the element.
 * @param {string} id - The ID of the element to remove the highlight from.
 */
function removeHighlight(id) {
    document.getElementById(id).classList.remove('drag-area-highlight');
    document.getElementById(id).style.backgroundColor = '';
}

/**
 * Filters tasks displayed on the board based on a user's search input.
 * This function dynamically updates the task display as the user types, showing only tasks that match the search criteria.
 */
function search() {
    let search = document.getElementById('search').value.toLowerCase();
    let cardTodo = document.getElementById('todo');
    let cardProgress = document.getElementById('progress');
    let cardFeedback = document.getElementById('feedback');
    let cardDone = document.getElementById('done');

    updateCategory(cardTodo, 'todo', search);
    updateCategory(cardProgress, 'progress', search);
    updateCategory(cardFeedback, 'feedback', search);
    updateCategory(cardDone, 'done', search);
}

/**
 * Updates the display of tasks within a specific category based on a search query.
 * Only tasks that match the search criteria within the specified category are displayed.
 * @param {HTMLElement} card - The card element to update.
 * @param {string} category - The category of tasks to be filtered.
 * @param {string} search - The search query used for filtering tasks.
 */
function updateCategory(card, category, search) {
    card.innerHTML = '';
    for (let i = 0; i &lt; cards.length; i++) {
        const element = cards[i];
        if (element.status === category &amp;&amp;
            (element.headline.toLowerCase().includes(search) ||
                element.text.toLowerCase().includes(search) ||
                search === '')) {
            card.innerHTML += generateCardHTML(element);
            userTags(element);
        }
    }
    emptyCategory();
}

/**
 * Fills categories with a message indicating no tasks are present if they are empty.
 * This provides visual feedback to users that a category contains no tasks.
 */
function emptyCategory() {
    let emptytodo = document.getElementById('todo');
    let emptyprogress = document.getElementById('progress');
    let emptyfeedback = document.getElementById('feedback');
    let emptydone = document.getElementById('done');

    if (emptytodo.innerHTML === "") {
        emptytodo.innerHTML += `
                &lt;div class="emptyContainer">
                    &lt;div class="empty">
                        &lt;span>No task To do&lt;/span>
                    &lt;/div>
                &lt;/div>`;
    }
    if (emptyprogress.innerHTML === "") {
        emptyprogress.innerHTML += `
                &lt;div class="emptyContainer">
                    &lt;div class="empty">
                        &lt;span>No task Progress&lt;/span>
                    &lt;/div>
                &lt;/div>`;
    }
    if (emptyfeedback.innerHTML === "") {
        emptyfeedback.innerHTML += `
                &lt;div class="emptyContainer">
                    &lt;div class="empty">
                        &lt;span>No task Feedback&lt;/span>
                    &lt;/div>
                &lt;/div>`;
    }
    if (emptydone.innerHTML === "") {
        emptydone.innerHTML += `
                &lt;div class="emptyContainer">
                    &lt;div class="empty">
                        &lt;span>No task Done&lt;/span>
                    &lt;/div>
                &lt;/div>`;
    }
}

/**
 * Opens an overlay or modal with detailed information about a specific task.
 * This function is triggered when a user interacts with a task card intending to view more details.
 * @param {number} i - The index or identifier for the task.
 * @param {string} elementData - Encoded data representing the task details.
 */
function openOverview(i, elementData) {
    let infoArrayCard = cards.find(task => {
        return task.id == i;
    });

    let element = JSON.parse(decodeURIComponent(elementData));
    let removeClass = document.getElementById('overlay');
    removeClass.innerHTML = '';
    removeClass.innerHTML = generateOverviewHTML(infoArrayCard);
    removeClass.classList.remove('d-none');
    subtaskLoad(i);
    assignedToEdit(infoArrayCard, i);
    userTagsOver(element);
}

/**
 * Closes the detailed information overlay or modal, returning the user to the main board view.
 */
function closeOverview() {
    let overviewElement = document.getElementById('overlay');
    overviewElement.classList.add('d-none');
}

/**
 * Updates the displayed count of completed versus total subtasks for a given task.
 * This visual indicator helps users track progress on composite tasks.
 * @param {Object} element - The task element containing subtasks.
 */
function subtasksCheck(element) {
    let id = element.id;
    let subtasks = element.subtasks ? element.subtasks.length : 0;
    let trueCount = 0;
    for (let i = 0; i &lt; subtasks; i++) {
        if (element.subtasks[i].done === true) {
            trueCount++;
        }
    }
    let subtaskHTMLCount = document.getElementById(`subtaskBar${id}`);
    subtaskHTMLCount.innerHTML = `&lt;span>${trueCount}/${subtasks} Subtasks&lt;/span>`;
}

/**
 * Populates the subtask list for a given task, marking each as complete or incomplete based on their status.
 * This function is used when viewing detailed information about a task.
 * @param {number} id - The ID of the task whose subtasks are being loaded.
 */
function subtaskLoad(id) {
    let card = cards.find(card => card.id === id);
    if (card &amp;&amp; Array.isArray(card.subtasks) &amp;&amp; card.subtasks.length > 0) {
        for (let i = 0; i &lt; card.subtasks.length; i++) {
            const specificSubtask = card.subtasks[i].name;
            const isDone = card.subtasks[i].done;
            let subtaskHTML = document.getElementById('unorderedListOfSubtask');
            subtaskHTML.innerHTML += `&lt;li>&lt;input type="checkbox" id="check${i}" ${isDone ? 'checked' : ''} onclick="subtasksCheckForTrue(${id}, ${i})">${specificSubtask}&lt;/li>`;
        }
    }
}

/**
 * Marks a subtask as complete or incomplete and updates the display to reflect this change.
 * This function is called when a user interacts with a subtask checkbox.
 * @param {number} cardId - The ID of the task containing the subtask.
 * @param {number} subtaskID - The index of the subtask within the task.
 */
function subtasksCheckForTrue(cardId, subtaskID) {
    let checkbox = document.getElementById(`check${subtaskID}`).checked;
    let card = cards.find(card => card.id === cardId);

    if (checkbox === true) {
        card.subtasks[subtaskID].done = true;
    } else if (checkbox === false) {
        card.subtasks[subtaskID].done = false;
    }
    subtasksCheck(card);
    updateProgressBar(card);
}

/**
 * Checks if subtasks exist and generates HTML for a progress bar if true.
 * @param {Object} card - The task element containing subtasks.
 */
function isSubTaskTrue(card) {
    if (card.subtasks.length > 0) {
        document.getElementById('isSubTaskTrue').innerHTML = `
        &lt;div class="progress-container">
        &lt;div class="progress-bar" id="progressBarId${card['id']}">
        
        &lt;/div>
        &lt;/div>
        &lt;div id="subtaskBar${card['id']}">
        `;
    }
}

/**
 * Dynamically updates a progress bar for a task based on the completion status of its subtasks.
 * This provides a visual representation of overall task progress.
 * @param {Object} element - The task element whose progress bar should be updated.
 */
async function updateProgressBar(element) {
    if (Array.isArray(element.subtasks) &amp;&amp; element.subtasks.length > 0) {
        let currentProgress = element.subtasks.filter(subtask => subtask.done).length;
        let percent = Math.round((currentProgress / element.subtasks.length) * 100);

        let progressBarContainer = document.getElementById(`progressBarId${element.id}`);
        if (!progressBarContainer) {
            let container = document.getElementById('isSubTaskTrue');
            container.innerHTML = `
            &lt;div class="progress-container">
                &lt;div class="progress-bar" id="progressBarId${element.id}" style="width: ${percent}%">&lt;/div>
            &lt;/div>
            &lt;div id="subtaskBar${element.id}">&lt;span>${currentProgress}/${element.subtasks.length} Subtasks&lt;/span>&lt;/div>
            `;
        } else {
            progressBarContainer.style.width = `${percent}%`;
            let subtaskHTMLCount = document.getElementById(`subtaskBar${element.id}`);
            subtaskHTMLCount.innerHTML = `&lt;span>${currentProgress}/${element.subtasks.length} Subtasks&lt;/span>`;
        }
    }
    //  await setItem('tasks/', tasks);
}

/**
 * Opens a modal or overlay for editing the details of a task.
 * Users can modify the title, description, and other properties of the task.
 * @param {number} cardId - The ID of the task being edited.
 */
function editCard(cardId) {
    let infoArrayCard = cards.find(card => card.id === cardId);
    currentDraggedElement = cards.find(card => card.id === cardId);
    let overlay = document.getElementById('overlay');
    overlay.innerHTML = '';
    overlay.innerHTML = overviewEditHTML(cardId);
    overlay.classList.remove('d-none');

    let title = document.getElementById('editTitle');
    let textarea = document.getElementById('editTextarea');
    let data = document.getElementById('editDate');

    title.value = infoArrayCard['headline'];
    textarea.value = infoArrayCard['text'];
    data.value = infoArrayCard['date'];
    prioEdit(infoArrayCard['priority'], cardId, event);
    renderSubTaskInBoard(infoArrayCard);
    assignIconEditRender(cardId);
}

/**
 * Processes the form submission for editing a task, saving the changes.
 * This function is called when a user submits the task edit form.
 * @param {Event} event - The form submission event.
 * @param {number} cardId - The ID of the task being edited.
 */
async function CardEditForm(event, cardId) {
    event.stopPropagation();
    event.preventDefault();
    let infoArrayCard = cards.find(card => card.id === cardId);
    let titleEdit = document.getElementById('editTitle').value;
    let textareaEdit = document.getElementById('editTextarea').value;
    let dateEdit = document.getElementById('editDate').value;

    infoArrayCard.headline = titleEdit;
    infoArrayCard.text = textareaEdit;
    infoArrayCard.date = dateEdit;
    // await setItem('tasks/', tasks);
    currentChecktContact = [];
    closeOverview();
    updateHTML();

}

/**
 * Rendert die Subtasks im Bearbeitungspopup ("Edit") für eine bestimmte Karte.
 * @param {Object} card - Die Karte, für die die Subtasks gerendert werden sollen.
 */
function renderSubtasksInEditPopup(card) {
    let editSubTasksBox = document.getElementById('subTasksBox');
    editSubTasksBox.innerHTML = '';

    if (card.subtasks &amp;&amp; Array.isArray(card.subtasks) &amp;&amp; card.subtasks.length > 0) {
        card.subtasks.forEach((subtask, index) => {
            let subtaskHTML = saveEditeSubTaskHTML(subtask, index,);
            editSubTasksBox.innerHTML += subtaskHTML;
        });
    } else {
        editSubTasksBox.innerHTML = '&lt;p>No subtasks found for this task.&lt;/p>';
    }
}

/**
 * Deletes a specified task from the board and updates the layout to reflect the change.
 * This function is called when a user decides to remove a task.
 * @param {number} id - The ID of the task to delete.
 */
async function deleteCard(id) {

    await deleteItem('tasks', id);
    updateHTML();
    closeOverview();
}


/**
 * Updates the priority of a task based on user selection in the edit form.
 * This adjusts the visual priority indicator on the task card.
 * @param {number} prioID - The priority level selected by the user.
 * @param {number} cardId - The ID of the task being edited.
 * @param {Event} event - The event associated with the priority change.
 */
function prioEdit(prioID, cardId, event) {
    event.preventDefault()
    let card = cards.find(card => card.id === cardId)
    card.priority = prioID

    let selectedPrio0 = document.getElementById('btnUrgent');
    let selectedPrio1 = document.getElementById('btnMedium');
    let selectedPrio2 = document.getElementById('btnLow');
    prioArray = prioID;
    if (prioArray === 2) {
        selectedPrio2.classList.add('activePrio2');
        selectedPrio1.classList.remove('activePrio1');
        selectedPrio0.classList.remove('activePrio0');
    } else if (prioArray === 1) {
        selectedPrio2.classList.remove('activePrio2');
        selectedPrio1.classList.add('activePrio1');
        selectedPrio0.classList.remove('activePrio0');
    } else if (prioArray === 0) {
        selectedPrio2.classList.remove('activePrio2');
        selectedPrio1.classList.remove('activePrio1');
        selectedPrio0.classList.add('activePrio0');
    }
}

/**
 * Updates the assigned user display in the task editing overlay, showing who is currently assigned to the task.
 * @param {Object} element - The task element being edited.
 * @param {number} b - A parameter or identifier associated with the task.
 */
function assignedToEdit(element, b) {
    let assignProfil = document.getElementById(`assignedProfileName${b}`);
    assignProfil.innerHTML = '';
    for (let i = 0; i &lt; element.length; i++) {
        let userInitials = element.user.id;
        assignProfil.innerHTML += `
        &lt;div class="profileName">
            &lt;div class="assignedLetters" style="background-color: ${userInitials['bgColor']}">${userInitials['initials']}&lt;/div>
            &lt;span>${userInitials['name']}&lt;/span>
        &lt;/div>`;
    }
    assignIcon(element);
}

/**
 * Updates the assigned user icons displayed on the task card on the main board.
 * This visual cue indicates which users are associated with a task.
 * @param {Object} element - The task element to update.
 */
function assignIcon(element) {
    let assignIcon = document.getElementById(`iconProfile${element['id']}`);
    assignIcon.innerHTML = '';

    assignIcon.innerHTML += `
        &lt;div class="imgProfile">
            &lt;div class="assignedLetters" style="background-color: ${element.bgColor}">${element.initials}&lt;/div>
        &lt;/div>`;

}

/**
 * Toggles the display of categories on the board based on a user event.
 * This function is a wrapper around the `toggleCategories` function, ensuring it can be easily called from UI events.
 * @param {Event} event - The event that triggered the toggle action.
 */
function toggleCategoriesBoard(event) {
    toggleCategories(event);
}

/**
 * Toggles the checkbox state for an assigned contact and triggers an update to the board's display based on this change.
 * This function is specifically designed to handle user interactions with contact checkboxes in the task assignment UI.
 * @param {string} userNameForId - A unique identifier for the user, used to construct the checkbox ID.
 * @param {Event} event - The event that triggered the action.
 * @param {string} initials - The initials of the user related to the checkbox.
 * @param {string} bgColor - The background color associated with the user, for UI display.
 * @param {string} name - The full name of the user.
 * @param {number} cardId - The ID of the card to which the user is being assigned or unassigned.
 */
function toggleCheckboxAndTriggerOnChange(userNameForId, event, initials, bgColor, name, cardId) {
    const checkboxId = `assignedToContact_${userNameForId}`;
    const checkbox = document.getElementById(checkboxId);
    if (checkbox) {
        checkbox.checked = !checkbox.checked;
        updateSelectedContactsBoard(initials, bgColor, name, cardId, checkbox, event);
    }
}

/**
 * Updates the assigned user icons for editing a task. This function refreshes the display of assigned user icons
 * in the task editing interface, showing the current state of user assignments based on `currentChecktContact`.
 */
function assignIconEdit() {
    let assignIcon = document.getElementById(`renderSelectedContacts`);
    assignIcon.innerHTML = '';

    for (let i = 0; i &lt; currentChecktContact.length; i++) {
        let icon = currentChecktContact[i];
        assignIcon.innerHTML += `
        &lt;div class="imgProfile">
            &lt;div class="assignedLetters" style="background-color: ${icon['bgColor']}">${icon['initials']}&lt;/div>
        &lt;/div>`;
    }
}

/**
 * Renders the assigned user icons in the task editing interface for a specific task.
 * This function pulls the current assigned users from the specified task and updates the display accordingly.
 * @param {number} cardId - The ID of the task for which to render assigned user icons.
 */
function assignIconEditRender(cardId) {
    let card = cards.find(card => card.id === cardId);
    console.log(card['user']);
    let assignIcon = document.getElementById(`renderSelectedContacts`);
    assignIcon.innerHTML = '';

    for (let i = 0; i &lt; card['user'].length; i++) {
        console.log(card['user'][i]['initials']);

        currentChecktContact.push({
            name: card['user'][i]['name'],
            bgColor: card['user'][i]['bgColor'],
            initials: card['user'][i]['initials']
        });

        assignIcon.innerHTML += `
        &lt;div class="imgProfile">
            &lt;div class="assignedLetters" style="background-color: ${card['user'][i]['bgColor']}">${card['user'][i]['initials']}&lt;/div>
        &lt;/div>`;
    }
}

/**
 * Toggles the display of an assigned user selection interface for a task on the board.
 * This allows users to assign or unassign other users to a task directly from the board.
 * @param {number} i - The index or identifier of the task.
 */
function toggleAssignedToBoard(i, event) {
    event.stopPropagation();
    let contactsBox = document.getElementById('contactsBox');
    if (contactsBox.style.display === 'none' || contactsBox.innerHTML.trim() === '') {
        assignedToBoard(i);
        contactsBox.style.display = 'block';
    } else {
        contactsBox.style.display = 'none';
    }

}

/**
 * Populates and displays the assigned user selection interface for a task, allowing users to be assigned to the task.
 * @param {number} cardId - The ID of the task for which users are being assigned.
 */
async function assignedToBoard(cardId) {
    await load_contacts_from_webstorage();
    let contactsBox = document.getElementById('contactsBox');
    contactsBox.innerHTML = '';
    let users = contacts[userID];
    let card = cards.find(card => card.id === cardId);
    if (!card) {
        return;
    }
    let assignedContacts = card.user || [];
    let uniqueUsers = {};
    for (let j = 0; j &lt; users.length; j++) {
        let user = users[j];
        let key = user['name'] + user['bgColor'];

        if (!uniqueUsers[key]) {
            let isChecked = assignedContacts.some(assignedUser => assignedUser.name === user.name &amp;&amp; assignedUser.bgColor === user.bgColor) ? 'checked' : '';
            contactsBox.innerHTML += assignedToBoardHTML(user, isChecked, cardId);
            uniqueUsers[key] = true;
        }
    }

}

/**
 * Updates the list of selected contacts for a task based on user interactions in the assigned user interface.
 * @param {string} initials - The initials of the user being selected or deselected.
 * @param {string} bgColor - The background color associated with the user.
 * @param {string} name - The name of the user.
 * @param {number} id - The ID of the task being updated.
 * @param {HTMLInputElement} checkbox - The checkbox input indicating whether the user is selected.
 */
function updateSelectedContactsBoard(initials, bgColor, name, id, checkbox, event) {
    event.stopPropagation();
    let key = name + bgColor;
    if (checkbox.checked) {
        let isContactAlreadyAdded = currentChecktContact.some(contact => contact.name + contact.bgColor === key);
        if (!isContactAlreadyAdded) {
            currentChecktContact.push({
                name: name,
                bgColor: bgColor,
                initials: initials
            });
        }
    } else {
        currentChecktContact = currentChecktContact.filter(contact => !(contact.name === name &amp;&amp; contact.bgColor === bgColor));
    }
    updateAssignedUsersInCard(id);
    assignIconEdit(id);
}

/**
* Saves the updated list of assigned users to a task and refreshes the task's display on the board.
* @param {number} id - The ID of the task for which assigned users are being updated.
*/
async function updateAssignedUsersInCard(id) {
    let cardIndex = cards.findIndex(card => card.id === Number(id));
    if (cardIndex !== -1) {

        cards[cardIndex].user = currentChecktContact;
        await setItem('tasks', cards);
        assignIcon(cards[cardIndex]);

    }
}

/**
 * Opens an overlay or modal for adding a new task, pre-selecting a specified category.
 * @param {string} category - The category to pre-select for the new task.
 */
async function addTaskHTMLOpen(category) {
    categorys.push(category);
    let openAddTask = document.getElementById('overlay');
    if (!openAddTask) {
        return;
    }
    openAddTask.innerHTML = '';
    openAddTask.innerHTML = addTaskHTML();
    openAddTask.classList.remove('d-none');

    categorys = [];
    updateHTML();
}

/**
 * Closes the add task overlay or modal, discarding any input and returning to the board view.
 */
function addTaskHTMLClose() {
    let openAddTask = document.getElementById('overlay');
    openAddTask.innerHTML = '';
    openAddTask.classList.add('d-none');
}

/**
 * Updates the display of user tags (e.g., "User Story", "Technical Task") for a task based on its label.
 * This function adjusts the visual styling of the task card to reflect the type of task.
 * @param {Object} element - The task element to update with user tags.
 */
function userTags(element) {
    let labelsID = 'labelsBoard' + element.id;
    let tagName = 'User Story';
    if (element.category.includes(tagName)) {
        let userLabelStory = document.getElementById(labelsID);
        userLabelStory.classList.add('userStory');
    } else {
        let userLabelStory = document.getElementById(labelsID);
        userLabelStory.classList.add('technicalTask');
    }
}

/**
 * Specifically updates the display of user tags for a task in the overview or detail view, based on its label.
 * This adjusts the visual styling similar to `userTags`, but is intended for use in detailed task views.
 * @param {Object} element - The task element in the detail view to update with user tags.
 */
function userTagsOver(element) {
    let labelsID = "labelsBoard" + element.id;
    let tagName = 'User Story';
    if (element.category.includes(tagName)) {
        let userLabelStory = document.getElementById(labelsID);
        userLabelStory.classList.add('userStory');
    } else {
        let userLabelStory = document.getElementById(labelsID);
        userLabelStory.classList.add('technicalTask');
    }
}

/**
 * Handles the display toggle of a mobile category section based on its current visibility state.
 * @param {Event} event - The event object to prevent event propagation.
 * @param {string} id - The unique identifier for the category to be toggled.
 */
function mobileCategory(event, id) {
    event.stopPropagation();
    let openCategory = document.getElementById(`categoryOpenMobile${id}`);

    if (openCategory.style.display === 'none') {
        openCategory.style.display = 'block';
        openCategory.innerHTML = mobileCategoryHTML(id);
    } else {
        openCategory.style.display = 'none';
    }
}

/**
 * Assigns a new category to a task and updates the tasks in storage and UI.
 * @async
 * @param {string} categorys - The new category to assign to the task.
 * @param {Event} event - The event object to prevent event propagation.
 * @param {string} id - The unique identifier of the task to update.
 */
async function newCategoryHTMLOpen(categorys, event, id) {
    event.stopPropagation();
    currentDraggedElement = cards.find(card => card.id === id);
    currentDraggedElement.category = categorys;
    // await setItem('tasks', tasks);
    updateHTML();
}

/**
 * Renders the subtasks of a given task in the board.
 * @param {Object} infoArrayCard - The task object containing subtasks to render.
 */
function renderSubTaskInBoard(infoArrayCard) {
    renderInputSubTask(infoArrayCard);
    subtasksArrayEditTask = [];
    for (let i = 0; i &lt; infoArrayCard['subtasks'].length; i++) {
        let nameOfSubTask = infoArrayCard['subtasks'][i]['name'];
        subtasksArrayEditTask.push(infoArrayCard['subtasks'][i]);
    }
    loadSubOfArray();
}

/**
 * Initializes the subtask rendering process by clearing existing subtasks and setting up for new input.
 */
function loadSubOfArray() {
    let renderTask = document.getElementById('renderSubs');
    renderTask.innerHTML = '';
    for (let j = 0; j &lt; subtasksArrayEditTask.length; j++) {
        let subName = subtasksArrayEditTask[j]['name'];
        let subID = subtasksArrayEditTask[j]['subID'];
        let taskID = subtasksArrayEditTask[j]['taskID'];
        console.log(subName);
        renderTask.innerHTML += loadSubOfArrayHTML(subName, subID, taskID);
    }
}

/**
 * Prepares the input area for adding or editing subtasks for a specific task.
 * @param {Object} infoArrayCard - The task object for which subtasks are being edited or added.
 */
function renderInputSubTask(infoArrayCard) {
    let taskID = infoArrayCard['id'];
    let renderInputTasks = document.getElementById('subtasksContainerEdit');
    renderInputTasks.innerHTML = '';
    renderInputTasks.innerHTML = renderInputSubTaskHTML(taskID);
}

/**
 * Displays the edit interface for a specific subtask.
 * @param {string} subID - The unique identifier of the subtask to edit.
 * @param {string} subName - The current name of the subtask to be edited.
 * @param {string} taskID - The unique identifier of the task to which the subtask belongs.
 */
function editSubTaskInBoardCard(subID, subName, taskID) {
    let editSubBar = document.getElementById('editSubTaskContainer');
    editSubBar.innerHTML = editSubTaskInBoardCardHTML(subID, subName, taskID);
}

/**
 * Closes the edit interface for subtasks.
 */
function closeEditSubTaskInBoardCard() {
    let colseEditSubBar = document.getElementById('editSubTaskContainer');
    colseEditSubBar.innerHTML = '';
}

/**
 * Saves the edited subtask to the board and updates the UI.
 * @param {string} subID - The unique identifier of the subtask being edited.
 * @param {string} taskID - The unique identifier of the task to which the subtask belongs.
 */
function saveEditeSubTaskInBoardCard(subID, taskID) {
    let subTask = subtasksArrayEditTask.find(subtasksArrayEditTask => subtasksArrayEditTask.subID === subID);
    console.log(subTask);
    let valueOfInput = document.getElementById('editSubTaskInput').value;
    subTask.name = valueOfInput;
    loadSubOfArray();
    closeEditSubTaskInBoardCard();
    saveNewSubTaskToBoard(subID, taskID);
}

/**
 * Saves the current state of subtasks to a specific task.
 * @param {string} subID - The unique identifier of the subtask.
 * @param {string} taskID - The unique identifier of the task to which the subtasks belong.
 */
function saveNewSubTaskToBoard(subID, taskID) {
    let card = cards.find(card => card.id === taskID);
    card['subtasks'] = subtasksArrayEditTask;
}

/**
 * Deletes a subtask from the board and updates the task accordingly.
 * @param {string} subID - The unique identifier of the subtask to be deleted.
 * @param {string} taskID - The unique identifier of the task from which the subtask will be deleted.
 */
function deleteSubTaskInBoardCard(subID, taskID) {
    let index = subtasksArrayEditTask.findIndex(subtasksArrayEditTask => subtasksArrayEditTask.subID === subID);
    if (index !== -1) { // Stelle sicher, dass das Element gefunden wurde
        subtasksArrayEditTask.splice(index, 1);
    }
    loadSubOfArray();
    saveNewSubTaskToBoard(subID, taskID);
}

/**
 * Adds a new subtask to a task on the board.
 * @param {string} taskID - The unique identifier of the task to which the new subtask will be added.
 */
function addSubTaskToTheBoardCard(taskID) {
    let valueOfNewTask = document.getElementById('addSubTasks');
    if (valueOfNewTask.value.trim() !== '') {
        let newSubID = Date.now();
        subtasksArrayEditTask.push({
            name: valueOfNewTask.value.trim(),
            done: false,
            subID: newSubID,
            taskID: taskID,
        });
        valueOfNewTask.value = '';
        saveNewSubTaskToBoard(newSubID, taskID);
    }
    loadSubOfArray();
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#AuthenticationCheck">AuthenticationCheck</a></li><li><a href="global.html#CardEditForm">CardEditForm</a></li><li><a href="global.html#activForm">activForm</a></li><li><a href="global.html#addActiveStyle">addActiveStyle</a></li><li><a href="global.html#addCategory">addCategory</a></li><li><a href="global.html#addNewContact">addNewContact</a></li><li><a href="global.html#addSubTask">addSubTask</a></li><li><a href="global.html#addSubTaskToTheBoardCard">addSubTaskToTheBoardCard</a></li><li><a href="global.html#addTaskHTMLClose">addTaskHTMLClose</a></li><li><a href="global.html#addTaskHTMLOpen">addTaskHTMLOpen</a></li><li><a href="global.html#allowDrop">allowDrop</a></li><li><a href="global.html#assignIcon">assignIcon</a></li><li><a href="global.html#assignIconEdit">assignIconEdit</a></li><li><a href="global.html#assignIconEditRender">assignIconEditRender</a></li><li><a href="global.html#assignedTo">assignedTo</a></li><li><a href="global.html#assignedToBoard">assignedToBoard</a></li><li><a href="global.html#assignedToEdit">assignedToEdit</a></li><li><a href="global.html#bodySummary">bodySummary</a></li><li><a href="global.html#changeContactView">changeContactView</a></li><li><a href="global.html#checkNewContact">checkNewContact</a></li><li><a href="global.html#checkToken">checkToken</a></li><li><a href="global.html#checkUser">checkUser</a></li><li><a href="global.html#checkWelcomePopup">checkWelcomePopup</a></li><li><a href="global.html#clearForm">clearForm</a></li><li><a href="global.html#closeAddContactPopup">closeAddContactPopup</a></li><li><a href="global.html#closeAddNewContact">closeAddNewContact</a></li><li><a href="global.html#closeContactsBoxOnClickOutside">closeContactsBoxOnClickOutside</a></li><li><a href="global.html#closeEditContact">closeEditContact</a></li><li><a href="global.html#closeEditSubTask">closeEditSubTask</a></li><li><a href="global.html#closeEditSubTaskInBoardCard">closeEditSubTaskInBoardCard</a></li><li><a href="global.html#closeOverview">closeOverview</a></li><li><a href="global.html#confirmPassword">confirmPassword</a></li><li><a href="global.html#createAndLogNewCategory">createAndLogNewCategory</a></li><li><a href="global.html#createContact">createContact</a></li><li><a href="global.html#createContactObject">createContactObject</a></li><li><a href="global.html#createNewTaskObject">createNewTaskObject</a></li><li><a href="global.html#createTask">createTask</a></li><li><a href="global.html#createTaskCategory">createTaskCategory</a></li><li><a href="global.html#deleteCard">deleteCard</a></li><li><a href="global.html#deleteContact">deleteContact</a></li><li><a href="global.html#deleteContactQuestion">deleteContactQuestion</a></li><li><a href="global.html#deleteContactSure">deleteContactSure</a></li><li><a href="global.html#deleteEditContact">deleteEditContact</a></li><li><a href="global.html#deleteItem">deleteItem</a></li><li><a href="global.html#deleteSubTask">deleteSubTask</a></li><li><a href="global.html#deleteSubTaskInBoardCard">deleteSubTaskInBoardCard</a></li><li><a href="global.html#deselectAllContainers">deselectAllContainers</a></li><li><a href="global.html#disableContactContainer">disableContactContainer</a></li><li><a href="global.html#displayContactDetails">displayContactDetails</a></li><li><a href="global.html#displayEditUserAccount">displayEditUserAccount</a></li><li><a href="global.html#displayGuestUserPopup">displayGuestUserPopup</a></li><li><a href="global.html#displaySubtasks">displaySubtasks</a></li><li><a href="global.html#dropDownOpen">dropDownOpen</a></li><li><a href="global.html#editCard">editCard</a></li><li><a href="global.html#editContact">editContact</a></li><li><a href="global.html#editLoggedinUser">editLoggedinUser</a></li><li><a href="global.html#editSubTask">editSubTask</a></li><li><a href="global.html#editSubTaskInBoardCard">editSubTaskInBoardCard</a></li><li><a href="global.html#editUserAccount">editUserAccount</a></li><li><a href="global.html#emptyCategory">emptyCategory</a></li><li><a href="global.html#filteredContact">filteredContact</a></li><li><a href="global.html#generateRandomColor">generateRandomColor</a></li><li><a href="global.html#getEarliestUrgentTask">getEarliestUrgentTask</a></li><li><a href="global.html#getEditContact">getEditContact</a></li><li><a href="global.html#getInitials">getInitials</a></li><li><a href="global.html#getItem">getItem</a></li><li><a href="global.html#getLastLetter">getLastLetter</a></li><li><a href="global.html#getNextTaskId">getNextTaskId</a></li><li><a href="global.html#getTaskValue">getTaskValue</a></li><li><a href="global.html#getUrgendTask">getUrgendTask</a></li><li><a href="global.html#handleCheckboxClick">handleCheckboxClick</a></li><li><a href="global.html#handleResize">handleResize</a></li><li><a href="global.html#hideEditContactMobile">hideEditContactMobile</a></li><li><a href="global.html#highlight">highlight</a></li><li><a href="global.html#hourCheck">hourCheck</a></li><li><a href="global.html#ifCheckContact">ifCheckContact</a></li><li><a href="global.html#ifCheckTasks">ifCheckTasks</a></li><li><a href="global.html#includeHTML">includeHTML</a></li><li><a href="global.html#initBoard">initBoard</a></li><li><a href="global.html#initContacts">initContacts</a></li><li><a href="global.html#initTasks">initTasks</a></li><li><a href="global.html#initials">initials</a></li><li><a href="global.html#inputFrame">inputFrame</a></li><li><a href="global.html#isMobile">isMobile</a></li><li><a href="global.html#isSubTaskTrue">isSubTaskTrue</a></li><li><a href="global.html#loadSubOfArray">loadSubOfArray</a></li><li><a href="global.html#loadTasks">loadTasks</a></li><li><a href="global.html#load_contacts_from_webstorage">load_contacts_from_webstorage</a></li><li><a href="global.html#login">login</a></li><li><a href="global.html#logout">logout</a></li><li><a href="global.html#mobileCategory">mobileCategory</a></li><li><a href="global.html#moveTo">moveTo</a></li><li><a href="global.html#newCategoryHTMLOpen">newCategoryHTMLOpen</a></li><li><a href="global.html#openMobileSidebar">openMobileSidebar</a></li><li><a href="global.html#openOrCloseHeaderLinksPopUp">openOrCloseHeaderLinksPopUp</a></li><li><a href="global.html#openOverview">openOverview</a></li><li><a href="global.html#passwordCheck">passwordCheck</a></li><li><a href="global.html#popupDeleteContact">popupDeleteContact</a></li><li><a href="global.html#preventDefaultBehavior">preventDefaultBehavior</a></li><li><a href="global.html#prioEdit">prioEdit</a></li><li><a href="global.html#register">register</a></li><li><a href="global.html#removeHighlight">removeHighlight</a></li><li><a href="global.html#render">render</a></li><li><a href="global.html#renderInputSubTask">renderInputSubTask</a></li><li><a href="global.html#renderSelectedContacts">renderSelectedContacts</a></li><li><a href="global.html#renderSubTaskInBoard">renderSubTaskInBoard</a></li><li><a href="global.html#renderSubtasksInEditPopup">renderSubtasksInEditPopup</a></li><li><a href="global.html#renderSummary">renderSummary</a></li><li><a href="global.html#resetInputFields">resetInputFields</a></li><li><a href="global.html#restoreSelectedLink">restoreSelectedLink</a></li><li><a href="global.html#saveAndShowContacts">saveAndShowContacts</a></li><li><a href="global.html#saveEditContact">saveEditContact</a></li><li><a href="global.html#saveEditeSubTask">saveEditeSubTask</a></li><li><a href="global.html#saveEditeSubTaskInBoardCard">saveEditeSubTaskInBoardCard</a></li><li><a href="global.html#saveNewSubTaskToBoard">saveNewSubTaskToBoard</a></li><li><a href="global.html#screenSizeUser">screenSizeUser</a></li><li><a href="global.html#scrollToContactView">scrollToContactView</a></li><li><a href="global.html#search">search</a></li><li><a href="global.html#searchContact">searchContact</a></li><li><a href="global.html#selectClickedContainer">selectClickedContainer</a></li><li><a href="global.html#setGreeting">setGreeting</a></li><li><a href="global.html#setInitials">setInitials</a></li><li><a href="global.html#setItem">setItem</a></li><li><a href="global.html#setProfileContact">setProfileContact</a></li><li><a href="global.html#setUserName">setUserName</a></li><li><a href="global.html#showContact">showContact</a></li><li><a href="global.html#showContacts">showContacts</a></li><li><a href="global.html#showEditContactMobile">showEditContactMobile</a></li><li><a href="global.html#showEditDeleteMobile">showEditDeleteMobile</a></li><li><a href="global.html#showOverlay">showOverlay</a></li><li><a href="global.html#showSuccessOverlay">showSuccessOverlay</a></li><li><a href="global.html#sidebarBG">sidebarBG</a></li><li><a href="global.html#sidebarBGTerms">sidebarBGTerms</a></li><li><a href="global.html#startDragging">startDragging</a></li><li><a href="global.html#startEditUserAccount">startEditUserAccount</a></li><li><a href="global.html#stopPropagation">stopPropagation</a></li><li><a href="global.html#subtaskLoad">subtaskLoad</a></li><li><a href="global.html#subtasksCheck">subtasksCheck</a></li><li><a href="global.html#subtasksCheckForTrue">subtasksCheckForTrue</a></li><li><a href="global.html#summeryTasks">summeryTasks</a></li><li><a href="global.html#termsBackButton">termsBackButton</a></li><li><a href="global.html#termsStatus">termsStatus</a></li><li><a href="global.html#toggleAssignedToBoard">toggleAssignedToBoard</a></li><li><a href="global.html#toggleCategories">toggleCategories</a></li><li><a href="global.html#toggleCategoriesBoard">toggleCategoriesBoard</a></li><li><a href="global.html#toggleCategorySelection">toggleCategorySelection</a></li><li><a href="global.html#toggleCheckboxAndTriggerOnChange">toggleCheckboxAndTriggerOnChange</a></li><li><a href="global.html#toggleContactSelection">toggleContactSelection</a></li><li><a href="global.html#toggleContacts">toggleContacts</a></li><li><a href="global.html#toggleMobileContactView">toggleMobileContactView</a></li><li><a href="global.html#updateAssignedUsersInCard">updateAssignedUsersInCard</a></li><li><a href="global.html#updateCategory">updateCategory</a></li><li><a href="global.html#updateContactView">updateContactView</a></li><li><a href="global.html#updateContacts">updateContacts</a></li><li><a href="global.html#updateHTML">updateHTML</a></li><li><a href="global.html#updateItem">updateItem</a></li><li><a href="global.html#updateLabels">updateLabels</a></li><li><a href="global.html#updatePrio">updatePrio</a></li><li><a href="global.html#updateProgressBar">updateProgressBar</a></li><li><a href="global.html#updateSelectedContacts">updateSelectedContacts</a></li><li><a href="global.html#updateSelectedContactsBoard">updateSelectedContactsBoard</a></li><li><a href="global.html#updateUser">updateUser</a></li><li><a href="global.html#updateUserAccount">updateUserAccount</a></li><li><a href="global.html#userTags">userTags</a></li><li><a href="global.html#userTagsOver">userTagsOver</a></li><li><a href="global.html#welcomeAnimation">welcomeAnimation</a></li><li><a href="global.html#welcomeSummary">welcomeSummary</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Thu Feb 13 2025 17:28:34 GMT+0100 (Mitteleuropäische Normalzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
